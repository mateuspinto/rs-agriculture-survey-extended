Epoch 99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:05<00:00,  1.06it/s, v_num=130, train_loss=0.210, train_oa=0.934, train_kappa=0.919, val_loss=0.741, val_oa=0.815, val_kappa=nan.0]`Trainer.fit` stopped: `max_epochs=100` reached.                                                                                                                                                                                                                                              
Epoch 99: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 6/6 [00:05<00:00,  1.06it/s, v_num=130, train_loss=0.210, train_oa=0.934, train_kappa=0.919, val_loss=0.741, val_oa=0.815, val_kappa=nan.0]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2]
/opt/conda/lib/python3.10/site-packages/pytorch_lightning/trainer/connectors/data_connector.py:215: Using `DistributedSampler` with the dataloaders. During `trainer.test()`, it is recommended to use `Trainer(devices=1, num_nodes=1)` to ensure each sample/batch gets evaluated exactly once. Otherwise, multi-device settings use `DistributedSampler` that replicates some samples to make sure all devices have same batch size in case of uneven inputs.
Testing DataLoader 0: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:03<00:00,  5.23it/s]
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       Test metric             DataLoader 0
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
       test_kappa                   nan
        test_loss           0.5657111406326294
         test_oa            0.8409069180488586
──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
tensor([[17836,    19,   104,    20,    18,    65,    69,   398,    52,     9,    48,   112,     7,   125,    19,   185,    28,     7],
        [   54,  4553,     8,    55,    13,    33,     1,     5,     0,    57,   158,     7,     0,     2,     1,     1,    13,     0],
        [   57,     4,  7422,     4,     3,     2,    89,    19,    21,     0,     1,    48,     0,     0,    47,     3,     1,    19],
        [   31,   129,     7,  1266,    10,    32,     0,     6,     1,    16,   175,     2,     0,     1,     0,     1,    25,     0],
        [   46,     9,     3,     3,   921,     4,     0,     3,     0,     4,    30,     1,     0,     6,     0,     0,     7,     0],
        [   22,    44,     9,     9,     4,   339,     2,     6,     6,     2,    65,     8,     3,     0,     0,     0,     4,     0],
        [    9,     0,    33,     0,     0,     3,   659,    37,    28,     0,     1,    62,     0,     0,    21,     1,     0,     2],
        [  113,     0,     7,     0,     1,     4,    34,  5450,     2,     0,     0,    90,     0,     8,     1,    46,     0,     0],
        [    1,     1,     2,     0,     0,     0,     3,     1,   506,     0,     2,     9,     5,     0,     0,     0,     0,     0],
        [   21,   411,     5,    15,     3,     6,     0,     0,     0,   257,    20,     0,     0,     1,     0,     0,    20,     0],
        [   37,    52,     1,    10,     0,    22,     1,     3,     0,     1,   853,     4,     0,     0,     0,     3,     0,     0],
        [   90,     0,    81,     1,     0,    14,   191,   142,    66,     1,     9,   795,    19,     7,    20,    37,     3,     3],
        [   13,     0,    16,     0,     0,    17,    79,     6,    62,     0,     1,    48,    61,     3,     3,     1,     2,     3],
        [ 1083,     6,    26,     6,    11,    39,    34,    84,    75,     1,    29,    68,     6,   394,    10,    36,    10,     5],
        [    8,     1,    65,     0,     0,     0,     7,     6,     1,     0,     1,    18,     0,     0,   582,     1,     1,     6],
        [  376,     0,     4,     0,     1,     3,    23,   300,     5,     0,     6,    44,     1,     1,     0,  1016,     0,     0],
        [   64,   155,    13,    54,    23,    50,     3,     3,     4,    60,     3,    13,     1,     1,     1,     0,    78,     2],
        [   38,     0,   104,     0,     1,     2,   137,    41,     3,     0,     2,    74,     0,    13,    11,     5,     3,    37]], device='cuda:0')
tensor([[17836,    19,   104,    20,    18,    65,    69,   398,    52,     9,    48,   112,     7,   125,    19,   185,    28,     7],
        [   54,  4553,     8,    55,    13,    33,     1,     5,     0,    57,   158,     7,     0,     2,     1,     1,    13,     0],
        [   57,     4,  7422,     4,     3,     2,    89,    19,    21,     0,     1,    48,     0,     0,    47,     3,     1,    19],
        [   31,   129,     7,  1266,    10,    32,     0,     6,     1,    16,   175,     2,     0,     1,     0,     1,    25,     0],
        [   46,     9,     3,     3,   921,     4,     0,     3,     0,     4,    30,     1,     0,     6,     0,     0,     7,     0],
        [   22,    44,     9,     9,     4,   339,     2,     6,     6,     2,    65,     8,     3,     0,     0,     0,     4,     0],
        [    9,     0,    33,     0,     0,     3,   659,    37,    28,     0,     1,    62,     0,     0,    21,     1,     0,     2],
        [  113,     0,     7,     0,     1,     4,    34,  5450,     2,     0,     0,    90,     0,     8,     1,    46,     0,     0],
        [    1,     1,     2,     0,     0,     0,     3,     1,   506,     0,     2,     9,     5,     0,     0,     0,     0,     0],
        [   21,   411,     5,    15,     3,     6,     0,     0,     0,   257,    20,     0,     0,     1,     0,     0,    20,     0],
        [   37,    52,     1,    10,     0,    22,     1,     3,     0,     1,   853,     4,     0,     0,     0,     3,     0,     0],
        [   90,     0,    81,     1,     0,    14,   191,   142,    66,     1,     9,   795,    19,     7,    20,    37,     3,     3],
        [   13,     0,    16,     0,     0,    17,    79,     6,    62,     0,     1,    48,    61,     3,     3,     1,     2,     3],
        [ 1083,     6,    26,     6,    11,    39,    34,    84,    75,     1,    29,    68,     6,   394,    10,    36,    10,     5],
        [    8,     1,    65,     0,     0,     0,     7,     6,     1,     0,     1,    18,     0,     0,   582,     1,     1,     6],
        [  376,     0,     4,     0,     1,     3,    23,   300,     5,     0,     6,    44,     1,     1,     0,  1016,     0,     0],
        [   64,   155,    13,    54,    23,    50,     3,     3,     4,    60,     3,    13,     1,     1,     1,     0,    78,     2],
        [   38,     0,   104,     0,     1,     2,   137,    41,     3,     0,     2,    74,     0,    13,    11,     5,     3,    37]], device='cuda:1')
tensor([[17836,    19,   104,    20,    18,    65,    69,   398,    52,     9,    48,   112,     7,   125,    19,   185,    28,     7],
        [   54,  4553,     8,    55,    13,    33,     1,     5,     0,    57,   158,     7,     0,     2,     1,     1,    13,     0],
        [   57,     4,  7422,     4,     3,     2,    89,    19,    21,     0,     1,    48,     0,     0,    47,     3,     1,    19],
        [   31,   129,     7,  1266,    10,    32,     0,     6,     1,    16,   175,     2,     0,     1,     0,     1,    25,     0],
        [   46,     9,     3,     3,   921,     4,     0,     3,     0,     4,    30,     1,     0,     6,     0,     0,     7,     0],
        [   22,    44,     9,     9,     4,   339,     2,     6,     6,     2,    65,     8,     3,     0,     0,     0,     4,     0],
        [    9,     0,    33,     0,     0,     3,   659,    37,    28,     0,     1,    62,     0,     0,    21,     1,     0,     2],
        [  113,     0,     7,     0,     1,     4,    34,  5450,     2,     0,     0,    90,     0,     8,     1,    46,     0,     0],
        [    1,     1,     2,     0,     0,     0,     3,     1,   506,     0,     2,     9,     5,     0,     0,     0,     0,     0],
        [   21,   411,     5,    15,     3,     6,     0,     0,     0,   257,    20,     0,     0,     1,     0,     0,    20,     0],
        [   37,    52,     1,    10,     0,    22,     1,     3,     0,     1,   853,     4,     0,     0,     0,     3,     0,     0],
        [   90,     0,    81,     1,     0,    14,   191,   142,    66,     1,     9,   795,    19,     7,    20,    37,     3,     3],
        [   13,     0,    16,     0,     0,    17,    79,     6,    62,     0,     1,    48,    61,     3,     3,     1,     2,     3],
        [ 1083,     6,    26,     6,    11,    39,    34,    84,    75,     1,    29,    68,     6,   394,    10,    36,    10,     5],
        [    8,     1,    65,     0,     0,     0,     7,     6,     1,     0,     1,    18,     0,     0,   582,     1,     1,     6],
        [  376,     0,     4,     0,     1,     3,    23,   300,     5,     0,     6,    44,     1,     1,     0,  1016,     0,     0],
        [   64,   155,    13,    54,    23,    50,     3,     3,     4,    60,     3,    13,     1,     1,     1,     0,    78,     2],
        [   38,     0,   104,     0,     1,     2,   137,    41,     3,     0,     2,    74,     0,    13,    11,     5,     3,    37]], device='cuda:2')